/*! 2016 Baidu Inc. All Rights Reserved */
define("common/cache",["require"],function(require){var e={},t="userInfo";return{setBatch:function(e){e||(e={});for(var t in e)if(e.hasOwnProperty(t))this.set(t,e[t])},set:function(t,i){return e[t]=i,this},get:function(t){return e[t]},clear:function(){return e={},this},remove:function(t){if(t)delete e[t];return this},setUserInfo:function(e){this.set(t,e||{})},getUserInfo:function(e){var i=this.get(t)||{};return e?i[e]:i},getUserGroup:function(){var e=this.getUserInfo();return{name:e.groupName,isOwner:e.isGroupOwner}},userHasGroup:function(){return!!this.getUserInfo().hasGroup},userIsGroupOwner:function(){return this.getUserInfo().isGroupOwner},setUserGroupName:function(e){this.getUserInfo().groupName=e},isUserStudent:function(){return this.getUserInfo("isStudent")}}}),define("common/page_9c1894bc",["require","bootstrap/collapse","bootstrap/dropdown","common/cache"],function(require){function e(e){var t=$(window).scrollTop()>100;e[t?"fadeIn":"fadeOut"]()}function t(){var t='<a id="gotop" style="display: none;"><span class="glyphicon glyphicon-menu-up up-icon" aria-hidden="true"></span></a>',i=$(t).appendTo(document.body);i.on("click",function(){$(document.body).stop().animate({scrollTop:0},200)}),$(window).on("scroll",$.proxy(e,this,i)),e(i)}require("bootstrap/collapse"),require("bootstrap/dropdown");var i=require("common/cache");return{init:function(e,n){i.setUserInfo(e),n&&t()}}}),define("common/uiHelper",["require","jquery","bootstrap/modal"],function(require){function e(){if(s){r.modal("hide");var e=s;s=null,e()}}function t(){if(!r)r=n("#confirm-msg-dlg"),n(".ok-btn",r).on("click",e)}function i(){if(!a)a=n("#alert-msg-dlg")}var n=require("jquery");require("bootstrap/modal");var a,r,s,exports={};return exports.toggleBtnLoadingState=function(e,t){e.button(t?"loading":"reset")},exports.openComfirmDlg=function(e,i){t(),n(".modal-body",r).html(e),r.modal("show"),s=i},exports.openAlertDlg=function(e){i(),n(".modal-body",a).html(e),a.modal("show")},exports.toggleBtnDisableState=function(e,t,i){if(e.prop("disabled",t),i)e.siblings("button").prop("disabled",t)},exports.getInputValue=function(e,t){return e&&e.val().trim().substr(0,t||100)},exports.jqformArr2Obj=function(e){for(var t={},i=0,n=e.length;n>i;i++)t[e[i].name]=e[i].value.trim();return t},exports}),define("review/submit",["require","common/uiHelper","jquery","bootstrap/modal","bootstrap/button","bootstrap-slider"],function(require){function e(){h.modal("show")}function t(e,t){var i=f(".submit-tip",h);i[t?"addClass":"removeClass"]("text-danger"),i[t?"removeClass":"addClass"]("text-success"),i.html(e)}function i(){var e=f("#review-comment").val().trim();if(!e.length)return t("评论不能为空",!0),!1;else return!0}function n(){d.toggleBtnLoadingState(g,!0),d.toggleBtnDisableState(m,!0);var e=d.jqformArr2Obj(v.serializeArray());e.workId=c.workId,f.post("/2016/review/submit",e,"json").then(function(e){d.toggleBtnLoadingState(g,!1),d.toggleBtnDisableState(m,!1);var i=0===+e.status;if(i)h.modal("hide"),window.location.reload();else t(e.statusInfo||"提交失败",!0)})}function a(){var e=d.jqformArr2Obj(v.serializeArray());e.reviewId=p.id,f.post("/2016/review/update",e,"json").then(function(i){d.toggleBtnDisableState(m,!1);var n=0===+i.status;if(n)t("更新成功",!1),y&&y(e);else t(i.statusInfo||"更新失败",!0)})}function r(){if(i())if(p)a();else n()}function s(e,t,i){var n=f(t,e);if(arguments.length>2)n.text(i);return n.text()}function o(e,t){return s(e,".review-comment .comment",t)}function l(e,t){return s(e,".score-info .score",t)}function u(){var t=f(this).parents(".review-result");p={id:t.data("id"),comment:o(t),score:l(t)},f("#review-comment",v).val(p.comment||""),b.data("slider").setValue(+p.score,!0,!0),y=function(e){o(t,e.comment),l(t,e.score);var i=f(".update-time",t);if(i.length)i.text("已更新").addClass("text-success");else f(".time",t).after('<span class="update-time text-success">已更新</span>')},e()}var d=require("common/uiHelper"),f=require("jquery");require("bootstrap/modal"),require("bootstrap/button"),require("bootstrap-slider");var c,p,h,m,g,v,b,y,S,exports={};return exports.init=function(e){if(!S)if(S=!0,h=f("#submit-review-dlg"),h.length)m=f(".submit-btn",h),m.on("click",r),v=f(".submit-review-form",h),b=f("#review-score",h).slider({formatter:function(e){return e+"分"}}),b.on("change",function(e){f(".score-value",h).html(e.value.newValue)}),c=e},exports.initAddReview=function(t){exports.init(t),g=f(".submit-group-info .review-btn"),g.on("click",e)},exports.initUpdateReview=function(e){exports.init(e),f(".review-result-list").on("click",".update-review",u)},exports}),define("common/constants",["require"],function(require){var exports={};return exports.LOADING_TPL='<div class="loading-wrap"><span class="loading glyphicon glyphicon-refresh" aria-hidden="true"></span></div>',exports}),define("common/util",["require"],function(require){var exports={};return exports.getStrLen=function(e){var t=/[^\x00-\xff]/g;return e.replace(t,"**").length},exports.encodeHTML=function(e){if(!e)return"";else return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},exports}),function(e){function t(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i];return e}function i(){this.raw=[],this.length=0}function n(){return"___"+L++}function a(e,t){var i=new Function;i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function r(e){return B[e]}function s(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function o(e){return e.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(e){return"\\"+e})}function l(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,i){return t[i-0+1]})}function u(e){return e=e.replace(/^\s*\*/,""),l('gv({0},["{1}"])',s(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function d(e,t,i,n,a,r){for(var s=i.length,o=e.split(t),l=0,u=[],d=0,f=o.length;f>d;d++){var c=o[d];if(d){var p=1;for(l++;;){var h=c.indexOf(i);if(0>h){u.push(l>1&&p?t:"",c);break}if(l=n?l-1:0,u.push(l>0&&p?t:"",c.slice(0,h),l>0?i:""),c=c.slice(h+s),p=0,0===l)break}if(0===l)a(u.join("")),r(c),u=[]}else c&&r(c)}if(l>0&&u.length>0)r(t),r(u.join(""))}function f(e,t,i){var n,a=[],r=t.options,o="",l="",c="",p="";if(i)o="ts(",l=")",c=N,p=P,n=r.defaultFilter;return d(e,r.variableOpen,r.variableClose,1,function(e){if(i&&e.indexOf("|")<0&&n)e+="|"+n;var r=e.indexOf("|"),s=(r>0?e.slice(0,r):e).replace(/^\s+/,"").replace(/\s+$/,""),d=r>0?e.slice(r+1):"",h=0===s.indexOf("*"),m=[h?"":o,u(s),h?"":l];if(d){d=f(d,t);for(var g=d.split("|"),v=0,b=g.length;b>v;v++){var y=g[v];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(y)){if(m.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)m.push(",",RegExp.$3);m.push(")")}}}a.push(c,m.join(""),p)},function(e){a.push(c,i?s(e):e,p)}),a.join("")}function c(e,t){this.value=e,this.engine=t}function p(e,t){this.value=e,this.engine=t,this.children=[],this.cloneProps=[]}function h(e,t){var i=e.stack,n=t?i.find(function(e){return e instanceof t}):i.bottom();if(n){for(var a;(a=i.top())!==n;){if(!a.autoClose)throw new Error(a.type+" must be closed manually: "+a.value);a.autoClose(e)}n.close(e)}return n}function m(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,p.call(this,e,t),this.blocks={}}function g(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,p.call(this,e,t),this.cloneProps=["name"]}function v(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,p.call(this,e,t),this.cloneProps=["name","state","blocks","target"],this.blocks={}}function b(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,p.call(this,e,t),this.cloneProps=["name","expr"]}function y(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,e,t),this.cloneProps=["name","args"]}function S(e,t){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,e,t),this.cloneProps=["name","args"]}function I(e,t){var i=new RegExp(l("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",o(t.options.variableOpen),o(t.options.variableClose)),"i");if(!i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,p.call(this,e,t),this.cloneProps=["list","item","index"]}function E(e,t){p.call(this,e,t)}function k(e,t){E.call(this,e,t)}function A(e,t){p.call(this,e,t)}function C(e,t){t.target=e;var i=t.engine,n=e.name;if(i.targets[n])switch(i.options.namingConflict){case"override":i.targets[n]=e,t.targets.push(n);case"ignore":break;default:throw new Error("[ETPL_TARGET_EXISTS]"+n)}else i.targets[n]=e,t.targets.push(n)}function T(e,t){_[e]=t,t.prototype.type=e}function R(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]*)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=t({},M)}function w(e,t){function n(){var e;if(f.length>0&&(e=f.join(""))){var i=new c(e,t);if(i.beforeAdd(u),l.top().addChild(i),f=[],t.options.strip&&u.current instanceof p)i.value=e.replace(/^[\x20\t\r]*\n/,"");u.current=i}}var a,r=t.options.commandOpen,s=t.options.commandClose,o=t.options.commandSyntax,l=new i,u={engine:t,targets:[],stack:l,target:null},f=[];return d(e,r,s,0,function(e){var i,l=o.exec(e);if(l&&(i=l[2]||"target")&&(a=_[i.toLowerCase()])&&"function"==typeof a){n();var d=u.current;if(t.options.strip&&d instanceof c)d.value=d.value.replace(/\r?\n[\x20\t]*$/,"\n");if(l[1])d=h(u,a);else{if(d=new a(l[3],t),"function"==typeof d.beforeOpen)d.beforeOpen(u);d.open(u)}u.current=d}else if(!/^\s*\/\//.test(e))f.push(r,e,s);a=null},function(e){f.push(e)}),n(),h(u),u.targets}i.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var i=this.raw[t];if(e(i))return i}}};var L=178245,B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},M={html:function(e){return e.replace(/[&<>"']/g,r)},url:encodeURIComponent,raw:function(e){return e}},x='var r="";',N="r+=",P=";",V="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)x="var r=[],ri=0;",N="r[ri++]=",V='return r.join("");';c.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;if(!e||t.strip&&/^\s*$/.test(e))return"";else return f(e,this.engine,1)},clone:function(){return this}},p.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();t&&t.addChild(this),e.stack.push(this)},close:function(e){if(e.stack.top()===this)e.stack.pop()},getRendererBody:function(){for(var e=[],t=this.children,i=0;i<t.length;i++)e.push(t[i].getRendererBody());return e.join("")},clone:function(){for(var e=this.constructor,t=new e(this.value,this.engine),i=0,n=this.children.length;n>i;i++)t.addChild(this.children[i].clone());for(var i=0,n=this.cloneProps.length;n>i;i++){var a=this.cloneProps[i];t[a]=this[a]}return t}};var D='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';a(m,p),a(g,p),a(v,p),a(b,p),a(y,p),a(S,p),a(I,p),a(E,p),a(k,E),a(A,E);var j={READING:1,READED:2,APPLIED:3,READY:4};v.prototype.applyMaster=m.prototype.applyMaster=function(e){function t(e){var n=e.children;if(n instanceof Array)for(var a=0,r=n.length;r>a;a++){var s=n[a];if(s instanceof g&&i[s.name])s=n[a]=i[s.name];t(s)}}if(this.state>=j.APPLIED)return 1;var i=this.blocks,n=this.engine.targets[e];if(n){if(n.applyMaster(n.master))return this.children=n.clone().children,t(this),this.state=j.APPLIED,1}else if("error"===this.engine.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+e+", when extended by "+(this.target?this.target.name:this.name))},m.prototype.isReady=function(){function e(a){for(var r=0,s=a.children.length;s>r;r++){var o=a.children[r];if(o instanceof v){var l=t.targets[o.name];if(!l&&"error"===t.options.missTarget)throw new Error("[ETPL_MISS_TARGET]"+o.name+", when imported by "+i);n=n&&l&&l.isReady(t)}else if(o instanceof p)e(o)}}if(this.state>=j.READY)return 1;var t=this.engine,i=this.name,n=1;if(this.applyMaster(this.master))return e(this),n&&(this.state=j.READY),n;else return void 0},m.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[D,x,this.getRendererBody(),V].join("\n")),t=this.engine;return this.renderer=function(i){return e(i,t)},this.renderer}return null},m.prototype.open=function(e){h(e),p.prototype.open.call(this,e),this.state=j.READING,C(this,e)},b.prototype.open=S.prototype.open=function(e){e.stack.top().addChild(this)},g.prototype.open=function(e){p.prototype.open.call(this,e),e.stack.find(function(e){return e.blocks}).blocks[this.name]=this},k.prototype.open=function(e){var t=new A;t.open(e);var i=h(e,E);i.addChild(this),e.stack.push(this)},A.prototype.open=function(e){var t=h(e,E);t.addChild(this),e.stack.push(this)},v.prototype.open=function(e){this.parent=e.stack.top(),this.target=e.target,p.prototype.open.call(this,e),this.state=j.READING},S.prototype.close=b.prototype.close=function(){},v.prototype.close=function(e){p.prototype.close.call(this,e),this.state=j.READED},m.prototype.close=function(e){p.prototype.close.call(this,e),this.state=this.master?j.READED:j.APPLIED,e.target=null},v.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0;for(var i in this.blocks)this.target.blocks[i]=this.blocks[i];this.blocks={},this.close(e)},S.prototype.beforeOpen=v.prototype.beforeOpen=b.prototype.beforeOpen=I.prototype.beforeOpen=y.prototype.beforeOpen=g.prototype.beforeOpen=E.prototype.beforeOpen=c.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new m(n(),e.engine);t.open(e)}},v.prototype.getRendererBody=function(){return this.applyMaster(this.name),p.prototype.getRendererBody.call(this)},S.prototype.getRendererBody=function(){return l("{0}engine.render({2},{{3}}){1}",N,P,s(this.name),f(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,i){return(t||"")+s(i)+":"}))},b.prototype.getRendererBody=function(){if(this.expr)return l("v[{0}]={1};",s(this.name),f(this.expr,this.engine));else return""},E.prototype.getRendererBody=function(){return l("if({0}){{1}}",f(this.value,this.engine),p.prototype.getRendererBody.call(this))},A.prototype.getRendererBody=function(){return l("}else{{0}",p.prototype.getRendererBody.call(this))},I.prototype.getRendererBody=function(){return l('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',n(),f(this.list,this.engine),s(this.index||n()),s(this.item),n(),n(),p.prototype.getRendererBody.call(this))},y.prototype.getRendererBody=function(){var e=this.args;return l("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",x,V,N,P,p.prototype.getRendererBody.call(this),s(this.name),e?","+f(e,this.engine):"")};var _={};T("target",m),T("block",g),T("import",v),T("use",S),T("var",b),T("for",I),T("if",E),T("elif",k),T("else",A),T("filter",y),R.prototype.config=function(e){t(this.options,e)},R.prototype.compile=R.prototype.parse=function(e){if(e){var t=w(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},R.prototype.getRenderer=function(e){var t=this.targets[e];if(t)return t.getRenderer();else return void 0},R.prototype.render=function(e,t){var i=this.getRenderer(e);if(i)return i(t);else return""},R.prototype.addFilter=function(e,t){if("function"==typeof t)this.filters[e]=t};var z=new R;if(z.Engine=R,z.version="3.1.0","object"==typeof exports&&"object"==typeof module)exports=module.exports=z;else if("function"==typeof define&&define.amd)define("etpl/main",[],z);else e.etpl=z}(this),define("etpl",["etpl/main"],function(e){return e}),define("common/tpl",["require","etpl"],function(require){var e=require("etpl"),exports={};return exports.createTplEngine=function(t){var i=new e.Engine;return i.compile(t),{render:function(e,t){var n=i.getRenderer(e);return n&&n(t||{})}}},exports.renderTpl=function(e,t){return e.replace(/\$\{(.+?)\}/g,function(e,i){return null==t[i]?"":t[i]})},exports}),define("review/reply",["require","bootstrap/modal","jquery-bootpag/jquery.bootpag","bootstrap/button","jquery","common/uiHelper","common/util","common/tpl"],function(require){function e(e){var t=d("#reply-comment",o);if(arguments.length)t.val(e);else return t.val().trim()}function t(){if(!s.prop("disabled"))e(""),i("");r.modal("show")}function i(e,t){var i=d(".submit-tip",r);i[t?"addClass":"removeClass"]("text-danger"),i[t?"removeClass":"addClass"]("text-success"),i.html(e)}function n(e){if(!e.reply.length)return i("评论内容不能为空",!0),!1;else return!0}function a(){i("");var e=f.jqformArr2Obj(o.serializeArray());if(n(e)){f.toggleBtnLoadingState(s,!0);var t=l.reviewWrap;e.reviewId=t.data("id"),d.post("/2016/review/reply",e,"json").then(function(e){f.toggleBtnLoadingState(s,!1);var n=0===+e.status;if(n){r.modal("hide");var a=d(".reply-wrap",t);if(!a.length)a=d('<ul class="reply-wrap"></ul>').insertAfter(d(".comment",t));d(c.renderTpl(p,e.data)).prependTo(a).fadeIn();var o=d(".more-btn em",a);o.text(+o.text()+1)}else i(e.statusInfo||"回复失败",!0)})}}require("bootstrap/modal"),require("jquery-bootpag/jquery.bootpag"),require("bootstrap/button");var r,s,o,l,u,d=require("jquery"),f=require("common/uiHelper"),c=(require("common/util"),require("common/tpl")),p='<li class="reply" data-id="${commentId}"><p class="reply-info">我的回复&nbsp;<span class="time">${replyTime}</span><button type="button" class="del-reply btn btn-link">删除</button></p><p class="reply-content">${replyContent}</p></li>',exports={};return exports.init=function(){if(!u)if(u=!0,r=d("#reply-review-dlg"),r.length)s=d(".submit-btn",r),s.on("click",a),o=d("form",r)},exports.openReplyDlg=function(e){l=e,exports.init(),t()},exports}),define("task/submit",["require","common/uiHelper","bootstrap/modal","bootstrap/button","bootstrapvalidator"],function(require){function e(){a.modal("show")}function t(e,t){var i=$(".submit-tip",a);i[t?"addClass":"removeClass"]("text-danger"),i[t?"removeClass":"addClass"]("text-success"),i.html(e)}function i(){if(o.validate(),o.isValid()){n.toggleBtnLoadingState(s,!0),n.toggleBtnDisableState(l,!0);var e=n.jqformArr2Obj(r.serializeArray());e.taskId=u.taskId;var i=u.isUpdate,d=i?"/2016/task/update":"/2016/task/submit";$.post(d,e,"json").then(function(e){n.toggleBtnLoadingState(s,!1),n.toggleBtnDisableState(l,!1);var r=0===+e.status;if(r)if(i)t("更新成功");else a.modal("hide"),l.replaceWith($('<a class="btn btn-success" href="'+e.data.reviewUrl+'">查看 review</a>')),l=null;else t(e.statusInfo||"提交失败",!0)})}}var n=require("common/uiHelper");require("bootstrap/modal"),require("bootstrap/button"),require("bootstrapvalidator");var a,r,s,o,l,u,exports={};return exports.init=function(t,n){u=t,a=$("#submit-task-dlg"),s=$(".save-btn",a).on("click",i),r=$(".submit-task-form",a),o=r.bootstrapValidator({live:"enabled",fields:{url:{validators:{notEmpty:{message:"代码地址不能为空"},uri:{message:"代码地址无效"}}},demo:{validators:{uri:{message:"demo 地址无效"}}},descr:{stringLength:{max:300,message:"描述不超过300个字"}}}}).data("bootstrapValidator"),l=n,l.on("click",e)},exports}),define("review/reviewDetail_2ad94d39",["require","common/page_9c1894bc","common/uiHelper","jquery","./submit","common/constants","bootstrap/button","jquery-bootpag/jquery.bootpag","./reply","../task/submit"],function(require){function e(){var e=h(this);p.toggleBtnLoadingState(e,!0),h.post("/2016/review/apply",{taskId:v.taskId}).then(function(t){var i=0===+t.status;if(p.toggleBtnLoadingState(e,!1),i)e.replaceWith('<span class="mentor-review text-success">导师 review 已申请</span>');else p.openAlertDlg(t.statusInfo||"申请失败，稍后再试")})}function t(e){var t=h(this),i=t.parents(".review-result").data("id");p.toggleBtnDisableState(t,!0);var n=t.data("type"),a=n?0:1;h.post("/2016/review/audit",{reviewId:i,auditType:a}).then(function(e){var i=0===+e.status;if(p.toggleBtnDisableState(t,!1),i)t.data("type",a),t.text(a?"取消标记为无效 review":"标记为无效 review"),t=null;else p.openAlertDlg(e.statusInfo||"操作失败")})}function i(e,t){var i;if(e)i='<li class="empty-tip text-danger">'+e+"</li>";else i=t.tpl,s(t);b.html(i)}function n(e){b.html('<li class="empty-tip">'+g+"</li>"),h.post("/2016/task/getReviewList",{pageNo:e||1,workId:v.workId},"json").then(function(e){var t=0===+e.status;i(t?null:e.statusInfo||"读取失败",e.data)})}function a(e,t){n(t)}function r(){return h(".review-page-wrap").off()}function s(e){var t=r(),i=e.pageSize,n=i&&Math.ceil(e.total/i);if(1>=n)t.hide();else t.bootpag({total:n,page:e.pageNo,maxVisible:10}).on("page",a),t.show()}function o(){var e=require("./reply"),t=h(this).parents(".review-result");e.openReplyDlg({reviewWrap:t})}function l(e,t){var i=0===+t.status;if(i)e.fadeOut(function(){var t=e.parent();if(e.remove(),!t.children().length)t.remove();else{var i=h(".more-btn em",t);i.text(i.text()-1)}});else p.openAlertDlg(t.statusInfo||"删除评论失败")}function u(){var e=h(this).parents(".reply"),t=e.data("id");p.openComfirmDlg("是否确认删除该评论",function(){h.post("/2016/review/deleteComment",{commentId:t},"json").then(h.proxy(l,this,e))})}function d(){var e=h(this);e.hide().parents(".reply-wrap").children().show(),e.parent().remove()}function f(){b=h(".review-result-list");var e=r();if(e.length)s({total:e.data("total"),pageNo:e.data("page-no"),pageSize:e.data("page-size")});h(".review-result-list").on("click",".audit-btn",t).on("click",".reply-btn",o).on("click",".del-reply",u).on("click",".more-btn",d)}var c=require("common/page_9c1894bc"),p=require("common/uiHelper"),h=require("jquery"),m=require("./submit"),g=require("common/constants").LOADING_TPL;require("bootstrap/button"),require("jquery-bootpag/jquery.bootpag");var v,b;return{init:function(t,i){if(c.init(t,!0),v=i,v.allowAddReview)m.initAddReview(v);else if(v.allowUpdateReview)m.initUpdateReview(v);h(".apply-review-btn").on("click",e);var n=h(".update-task-btn");if(n.length)require("../task/submit").init({taskId:i.taskId,isUpdate:!0},n);f()}}});